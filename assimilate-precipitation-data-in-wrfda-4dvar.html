<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  
  <title>WRFDA四维变分同化降水资料 | MeteoBoy4</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="介绍了利用WRFDA的四维变分同化（4DVAR）来同化降水资料的流程。">
<meta name="keywords" content="Python,同化,WRFDA">
<meta property="og:type" content="article">
<meta property="og:title" content="WRFDA四维变分同化降水资料">
<meta property="og:url" content="http://www.meteoboy.com/assimilate-precipitation-data-in-wrfda-4dvar.html">
<meta property="og:site_name" content="MeteoBoy4">
<meta property="og:description" content="介绍了利用WRFDA的四维变分同化（4DVAR）来同化降水资料的流程。">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2019-08-11T03:12:20.551Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="WRFDA四维变分同化降水资料">
<meta name="twitter:description" content="介绍了利用WRFDA的四维变分同化（4DVAR）来同化降水资料的流程。">
  
    <link rel="alternative" href="/atom.xml" title="MeteoBoy4" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.jpg">
  
  
      <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet">
  <script>
      var yiliaConfig = {
          rootUrl: '/',
          fancybox: true,
          animate: true,
          isHome: false,
          isPost: true,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
</head></html>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            
            <img lazy-src="/img/head.jpg" class="js-avatar">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/" title="Hi Mate">MeteoBoy4</a></h1>
        </hgroup>

        
        <p class="header-subtitle">书写是为了更好地思考</p>
        
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">首页</a></li>
                        
                            <li><a href="/archives">所有文章</a></li>
                        
                            <li><a href="/tags">标签云</a></li>
                        
                            <li><a href="/about">我的故事</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl mail" target="_blank" href="mailto:meteoboy4@gmail.com" title="mail">mail</a>
                            
                                <a class="fl github" target="_blank" href="https://github.com/MeteoBoy4" title="github">github</a>
                            
                                <a class="fl zhihu" target="_blank" href="https://www.zhihu.com/people/LichKing/activities" title="zhihu">zhihu</a>
                            
                                <a class="fl weibo" target="_blank" href="http://weibo.com/u/1955932927?refer_flag=1001030201_&is_all=1" title="weibo">weibo</a>
                            
                                <a class="fl douban" target="_blank" href="https://www.douban.com/people/45959129/" title="douban">douban</a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/Editor/" style="font-size: 10px;">Editor</a> <a href="/tags/Fortran/" style="font-size: 13.33px;">Fortran</a> <a href="/tags/Linux/" style="font-size: 16.67px;">Linux</a> <a href="/tags/NCL/" style="font-size: 10px;">NCL</a> <a href="/tags/Python/" style="font-size: 13.33px;">Python</a> <a href="/tags/VPS/" style="font-size: 10px;">VPS</a> <a href="/tags/WRF/" style="font-size: 20px;">WRF</a> <a href="/tags/WRFDA/" style="font-size: 10px;">WRFDA</a> <a href="/tags/云服务器/" style="font-size: 10px;">云服务器</a> <a href="/tags/博客/" style="font-size: 10px;">博客</a> <a href="/tags/同化/" style="font-size: 10px;">同化</a> <a href="/tags/诊断分析/" style="font-size: 13.33px;">诊断分析</a> <a href="/tags/远程开发/" style="font-size: 10px;">远程开发</a>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://mindhacks.cn/">刘未鹏</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://seisman.info/">seisman</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">热爱气象 热爱编程 更热爱思考</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="Me">MeteoBoy4</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/img/head.jpg" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="Me">MeteoBoy4</a></h1>
            </hgroup>
            
            <p class="header-subtitle">书写是为了更好地思考</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">首页</a></li>
                
                    <li><a href="/archives">所有文章</a></li>
                
                    <li><a href="/tags">标签云</a></li>
                
                    <li><a href="/about">我的故事</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="mail" target="_blank" href="mailto:meteoboy4@gmail.com" title="mail">mail</a>
                    
                        <a class="github" target="_blank" href="https://github.com/MeteoBoy4" title="github">github</a>
                    
                        <a class="zhihu" target="_blank" href="https://www.zhihu.com/people/LichKing/activities" title="zhihu">zhihu</a>
                    
                        <a class="weibo" target="_blank" href="http://weibo.com/u/1955932927?refer_flag=1001030201_&is_all=1" title="weibo">weibo</a>
                    
                        <a class="douban" target="_blank" href="https://www.douban.com/people/45959129/" title="douban">douban</a>
                    
                </div>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap"><article id="post-assimilate-precipitation-data-in-wrfda-4dvar" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/assimilate-precipitation-data-in-wrfda-4dvar.html" class="article-date">
      <time datetime="2017-10-05T21:22:30.000Z" itemprop="datePublished">2017-10-05</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      WRFDA四维变分同化降水资料
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        

        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/">Python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/WRFDA/">WRFDA</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/同化/">同化</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>介绍了利用WRFDA的四维变分同化（4DVAR）来同化降水资料的流程。</p>
<a id="more"></a>
<h2 id="动机"><a href="#动机" class="headerlink" title="动机"></a>动机</h2><p>传统意义上，小伙伴们使用WRF对高影响天气过程进行模拟时，最为关注的要素之一便是（累积）降水量。天有不测风云，模式也不是那么容易模拟好降水过程的。这时除了调整模式参数和配置外，最为有效的办法便是同化额外的观测资料了。</p>
<p>WRFDA是WRF团队开发的一整套同化程序，可以同化各种常规地面、高空观测，卫星辐射、雷达和降水观测资料。既然我们很关注降水量的模拟，在模拟预热期同化降水资料是不是更直接一些呢？</p>
<p>WRFDA支持三维变分（3DVAR）和四维变分（4DVAR），由于降水资料一般都是随时间累积量而非瞬时量，故应采用WRFDA的四维变分来同化降水资料。</p>
<h2 id="准备降水资料"><a href="#准备降水资料" class="headerlink" title="准备降水资料"></a>准备降水资料</h2><h3 id="资料格式"><a href="#资料格式" class="headerlink" title="资料格式"></a>资料格式</h3><p>WRFDA读取降水资料时，需要降水资料已经写成特定的ASCII格式。关于此格式<a href="http://www2.mmm.ucar.edu/wrf/users/wrfda/" target="_blank" rel="noopener">官网</a>并没有给出详细的说明，但是给出了一个Fortran小程序<a href="http://www2.mmm.ucar.edu/wrf/users/wrfda/download/precip_converter.tar.gz" target="_blank" rel="noopener">precip_converter</a>，利用它可以将NCEP的Stage IV降水资料处理成WRFDA可以读取的格式，其中给出的核心独立子程序writerainobs就是输入经纬度与降水资料而将其以WRFDA要求的格式输出到文件中的。这样再好不过，我们将其稍加修改，使用f2py将其改造成Python可以调用的子函数，便可直接构造相应格式的降水资料。</p>
<h3 id="Fortran"><a href="#Fortran" class="headerlink" title="Fortran"></a>Fortran</h3><p>稍加修改后的Fortran子函数放在我的<a href="https://gist.github.com/MeteoBoy4/132197f0135d11d0680db33bb7a7a794#file-write_rainobs-f90" target="_blank" rel="noopener">gist</a>上，其中文件名需要被命名为ob.rain.yyyymmddhh.xxh，xx代表累积降水量的时间跨度，后面的部分由SUFFIX变量传入。Fortran文件中加入了“!f2py”开头的注释，这是f2py特定可以读取的变量声明，以告诉Python哪些变量是准备输入的，哪些是准备输出的，以使得Python更好地生成文档以及使用Fortran函数。</p>
<h3 id="f2py"><a href="#f2py" class="headerlink" title="f2py"></a>f2py</h3><p>接下来便可通过</p>
<pre><code>f2py -c -m 外部module名 Fortran文件名
</code></pre><p>生成外部module供Python调用。</p>
<h3 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h3><p>我们以<a href="http://apps.webofknowledge.com/full_record.do?product=UA&amp;search_mode=GeneralSearch&amp;qid=1&amp;SID=N1Qh2M3LsfbRqvA82T1&amp;page=1&amp;doc=1" target="_blank" rel="noopener">TRMM 3B42</a>降水资料的处理为例写一个Python调用该module的小程序。该资料为3小时间隔，根据WRFDA文档的介绍，同化6小时累计是比较合理的，故我们取2个时次的平均。并手动生成经纬度一维数组以及时间后缀，然后在<a href="https://gist.github.com/MeteoBoy4/132197f0135d11d0680db33bb7a7a794#file-nc2wrfda-py" target="_blank" rel="noopener">Python脚本</a>中使用writerainobs函数，注意外部Fortran函数的import要放在脚本最前面。</p>
<p>降水资料数据就生成啦！</p>
<h2 id="同化降水资料"><a href="#同化降水资料" class="headerlink" title="同化降水资料"></a>同化降水资料</h2><h3 id="链接"><a href="#链接" class="headerlink" title="链接"></a>链接</h3><p>接下来按照官网的<a href="http://www2.mmm.ucar.edu/wrf/users/docs/user_guide_V3.8/users_guide_chap6.htm#_Precipitation_Data_Assimilation" target="_blank" rel="noopener">例子</a>一步一步做即可。记得将wrfinput_d01链接为fg（这两个文件必须都在同化工作目录下存在，不能只把wrfinput_d01链接为fg），同时将wrfbdy_d01直接链接过来（此处不用重命名）由于4DVAR需要不断运行WRF，故边界条件必须提供（3DVAR则不需要）；此处三个文件的名字都是强制的，所以在namelist里不必指定其位置与名字，降水资料在链接到同化工作目录时有特定的命名规则，详见官网。</p>
<h3 id="namelist"><a href="#namelist" class="headerlink" title="namelist"></a>namelist</h3><p>同化的namelist.input开启var4d，这里var4d_bin可设为一小时，而var4d_bin_rain则应该设为6小时（降水资料的累计时间），这样跑4DVAR的时候跑满6小时后反向时会以一小时为单位swap；在wrfvar4下开启use_rainobs；wrfvar5中指定是否进行质控并指定质控的严格程度，如果你希望将资料完全进入同化系统则可以将check_max_iv设为False，这样生成的rej_obs_conv_们（包含被拒绝入同化的数据）会全部为空；wrfvar6中控制了几层循环（天啊那不是更慢了），以及收敛的判据，WRFDA收敛是以目标函数的导数缩小为原来的百分比来判定的；时间对应到累积降水的起始与终止时刻，domain与physcis的信息完全依照wrfinput的来（即生成wrfinput的方案和配置，有些方案WRFPLUS里并没有，但是它会按照它有的来，不会报错）。具体的选项可以参考User’s Guide与官网的Tutorial的PPT。</p>
<h3 id="同化——更新初始场"><a href="#同化——更新初始场" class="headerlink" title="同化——更新初始场"></a>同化——更新初始场</h3><p>然后开始同化！</p>
<pre><code>./da_wrfvar.exe &amp;&gt; wrfda.log &amp;
</code></pre><p>可以看到利用WRFPLUSV3（一个简化的非线性WRF版本），同化系统不断地从降水累积起始时刻到终止时刻，来回循环地跑简化的WRF（正着跑，倒着跑..），并以最大梯度方向调整初始场使得WRF跑的结果向观测资料靠近，cost_fn与grad_fn可以看到梯度和目标函数的情况，还有很多文件可以查看WRFDA的具体诊断输出量，由于每一次循环相当于跑了二次（6小时）的WRF，完成4DVAR的速度会非常慢。当然从这里也可以看到4DVAR的好处，可以利用模式自身的动力对初始场进行调整，并且可以同化“未来”的观测值。</p>
<p>同化成功后将生成新的初始场，名为wrfvar_output，其格式与wrfinput_d0们完全一样，可以通过一些画图软件对比wrfinput与wrfvar_output的增量情况。</p>
<h3 id="同化——更新侧边界条件"><a href="#同化——更新侧边界条件" class="headerlink" title="同化——更新侧边界条件"></a>同化——更新侧边界条件</h3><p>更新了初始场以后，边界条件也必须更新以使得其与新的初始场保持协调，当然这一步只需对最外层进行，因为内层的侧边界条件是由外层提供的。</p>
<p>这一步是由da_update_bc.exe完成的，它也需要配一个namelist称为parame.in，将其中的update_lateral_bdy设为true，然后告诉它wrf_bdy的地址（将会覆盖原来的边界条件）和da_file（即上一步生成的wrfvar_output），加上一些别的选项（见User’s Guide）运行，更新！</p>
<p>至此，生成的新初边值就可以链接回原来WRF的运行目录，正常跑WRF即可。</p>
<h2 id="关于同化内层区域"><a href="#关于同化内层区域" class="headerlink" title="关于同化内层区域"></a>关于同化内层区域</h2><p>上面提到4DVAR在更新初始场的时候必须提供边界条件，这就给同化内层区域带来了问题（3DVAR不存在这一问题）：在运行real.exe或wrf.exe的时候内层区域只会生成初始场，并不会生成边界条件（wrfbdy_d02）。那么这个文件从哪里来呢，以下是我询问<a href="mailto:wrfhelp@ucar.edu" target="_blank" rel="noopener">wrfhelp</a>的回复：</p>
<blockquote>
<p>As you say, “producing exactly the wrfbdy_02 manually is not so easy”. But unfortunately this is the only way to do 4DVAR assimilation on a nested domain. If you have any questions on how to do this we are happy to help (there is enough information in the nested WRF file to create this domain exactly), but unfortunately there is no way around this inconvenience.</p>
</blockquote>
<p>也就是说，需要自己手动生成内层的边界条件！</p>
<p>哎~~</p>
<p>不过办法还是有的，就是麻烦点：</p>
<p>1.在WRF运行目录，把原来跑多层的namelist.input先备份以下；<br>2.将WPS目录下的met_em.d02们链接到WRF目录，但是链接为对应时间的met_em.d01们；<br>3.修改namelist.input：time_control部分不用动，在domains部分将max_dom修改为1，然后将time_step、e_we、e_sn、dx、dy的原第一列（对应最外层）删除，第二列（对应domain2）顺势成为第一列；注意此处grid_id、parent_id、i_parent_start、j_parent_start、parent_grid_ratio、parent_time_step_ratio保留原第一列的值（即都为1），虽然这样生成的wrfbdy_d02中的netCDF属性中这些值会为1，与其应有值冲突，但是并不会使得WRF、WRFDA报错；<br>4.运行real.exe，生成内层的边界条件文件（虽然名字叫wrfbdy_d01）；<br>5.按照与最外层一样的方法运行4DVAR。</p>
<p>上述办法不适合4DVAR循环同化（cycling）：wrf.exe不会生成边界文件。</p>
<p>试试看用新的初边值条件跑出来的结果，降水上是不是与你想要的结果更接近了呢？</p>

      
      
        <div class="page-reward">
          <p><a href="javascript:void(0)" onclick="dashangToggle()" class="dashang" title="打赏，支持一下">赏</a></p>
          <div class="hide_box"></div>
          <div class="shang_box">
            <a class="shang_close" href="javascript:void(0)" onclick="dashangToggle()" title="关闭">×</a>
            <div class="shang_tit">
              <p>碰并增长</p>
            </div>
            <div class="shang_payimg">
              <img src="/img/alipayimg.jpg" alt="扫码支持" title="扫一扫" />
            </div>
              <div class="pay_explain">扫码打赏，你说多少就多少</div>
            <div class="shang_payselect">
              
                <div class="pay_item checked" data-id="alipay">
                  <span class="radiobox"></span>
                  <span class="pay_logo"><img src="/img/alipay.png" alt="支付宝" /></span>
                </div>
              
              
                <div class="pay_item" data-id="wechat">
                  <span class="radiobox"></span>
                  <span class="pay_logo"><img src="/img/weixin.png" alt="微信" /></span>
                </div>
              
            </div>
            <div class="shang_info">
              <p>打开<span id="shang_pay_txt">支付宝</span>扫一扫，即可进行扫码打赏哦</p>
            </div>
          </div>
        </div>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js"></script>
        <script type="text/javascript">
          $(".pay_item").click(function(){
            $(this).addClass('checked').siblings('.pay_item').removeClass('checked');
            var dataid=$(this).attr('data-id');
            $(".shang_payimg img").attr("src","/img/"+dataid+"img.jpg");
            $("#shang_pay_txt").text(dataid=="alipay"?"支付宝":"微信");
          });
          function dashangToggle(){
            $(".hide_box").fadeToggle();
            $(".shang_box").fadeToggle();
          }
        </script>
      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/assimilate-precipitation-data-in-wrfda-4dvar.html">WRFDA四维变分同化降水资料</a></p>
        <p><span>文章作者:</span><a href="/" title="访问 MeteoBoy4 的个人博客">MeteoBoy4</a></p>
        <p><span>发布时间:</span>2017年10月05日 - 21时22分</p>
        <p><span>最后更新:</span>2019年08月11日 - 03时12分</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/assimilate-precipitation-data-in-wrfda-4dvar.html" title="WRFDA四维变分同化降水资料">http://www.meteoboy.com/assimilate-precipitation-data-in-wrfda-4dvar.html</a>
            <span class="copy-path" data-clipboard-text="原文: http://www.meteoboy.com/assimilate-precipitation-data-in-wrfda-4dvar.html　　作者: MeteoBoy4" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script src="/js/clipboard.min.js"></script>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="中国大陆 (CC BY-NC-SA 3.0 CN)" target = "_blank">"署名-非商用-相同方式共享 3.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



<nav id="article-nav">
  
    <a href="/build-vps-on-digital-ocean.html" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          在Digital Ocean上架设属于你的云服务器
        
      </div>
    </a>
  
  
    <a href="/vorticity-divergence-in-wrf-grid-practial.html" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">WRF格点下计算涡度散度谜团——操作篇</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>

    <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#动机"><span class="toc-number">1.</span> <span class="toc-text">动机</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#准备降水资料"><span class="toc-number">2.</span> <span class="toc-text">准备降水资料</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#资料格式"><span class="toc-number">2.1.</span> <span class="toc-text">资料格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Fortran"><span class="toc-number">2.2.</span> <span class="toc-text">Fortran</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#f2py"><span class="toc-number">2.3.</span> <span class="toc-text">f2py</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Python"><span class="toc-number">2.4.</span> <span class="toc-text">Python</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#同化降水资料"><span class="toc-number">3.</span> <span class="toc-text">同化降水资料</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#链接"><span class="toc-number">3.1.</span> <span class="toc-text">链接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#namelist"><span class="toc-number">3.2.</span> <span class="toc-text">namelist</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#同化——更新初始场"><span class="toc-number">3.3.</span> <span class="toc-text">同化——更新初始场</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#同化——更新侧边界条件"><span class="toc-number">3.4.</span> <span class="toc-text">同化——更新侧边界条件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#关于同化内层区域"><span class="toc-number">4.</span> <span class="toc-text">关于同化内层区域</span></a></li></ol>
</div>
<input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script>
    var valueHide = "隐藏目录";
    var valueShow = "显示目录";

    if ($(".left-col").is(":hidden")) {
        $("#tocButton").attr("value", valueShow);
    }
    $("#tocButton").click(function() {
        if ($("#toc").is(":hidden")) {
            $("#tocButton").attr("value", valueHide);
            $("#toc").slideDown(320);
        }
        else {
            $("#tocButton").attr("value", valueShow);
            $("#toc").slideUp(350);
        }
    })
    if ($(".toc").length < 1) {
        $("#toc, #tocButton").hide();
    }
</script>





<div class="bdsharebuttonbox">
	<a href="#" class="fx fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
	<a href="#" class="fx fa-weixin bds_weixin" data-cmd="weixin" title="分享到微信"></a>
	<a href="#" class="fx fa-qq bds_sqq" data-cmd="sqq" title="分享到QQ好友"></a>
	<a href="#" class="fx fa-facebook-official bds_fbook" data-cmd="fbook" title="分享到Facebook"></a>
	<a href="#" class="fx fa-twitter bds_twi" data-cmd="twi" title="分享到Twitter"></a>
	<a href="#" class="fx fa-linkedin bds_linkedin" data-cmd="linkedin" title="分享到linkedin"></a>
	<a href="#" class="fx fa-files-o bds_copy" data-cmd="copy" title="分享到复制网址"></a>
</div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>




    



    <div class="scroll" id="post-nav-button">
        
            <a href="/build-vps-on-digital-ocean.html" title="上一篇: 在Digital Ocean上架设属于你的云服务器">
                <i class="fa fa-angle-left"></i>
            </a>
        
        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>
        
            <a href="/vorticity-divergence-in-wrf-grid-practial.html" title="下一篇: WRF格点下计算涡度散度谜团——操作篇">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>
    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/vs-code-remote-development.html">使用VS Code进行远程开发</a></li><li class="post-list-item"><a class="post-list-link" href="/build-vps-on-digital-ocean.html">在Digital Ocean上架设属于你的云服务器</a></li><li class="post-list-item"><a class="post-list-link" href="/assimilate-precipitation-data-in-wrfda-4dvar.html">WRFDA四维变分同化降水资料</a></li><li class="post-list-item"><a class="post-list-link" href="/vorticity-divergence-in-wrf-grid-practial.html">WRF格点下计算涡度散度谜团——操作篇</a></li><li class="post-list-item"><a class="post-list-link" href="/vorticity-divergence-in-wrf-grid-formula.html">WRF格点下计算涡度散度谜团——公式篇</a></li><li class="post-list-item"><a class="post-list-link" href="/conda-without-internet.html">在无法连外网的服务器上安装Python包（conda）</a></li><li class="post-list-item"><a class="post-list-link" href="/90m-topo-in-WRF.html">WRF中使用SRTM90米地形高程资料</a></li><li class="post-list-item"><a class="post-list-link" href="/ssh-and-so-on.html">ssh那点事儿</a></li><li class="post-list-item"><a class="post-list-link" href="/Linux-Tianjing-sc.html">Linux下登陆天津超算</a></li><li class="post-list-item"><a class="post-list-link" href="/WRF-ERA-Interim.html">使用ERA-Interim驱动WRF3.9</a></li><li class="post-list-item"><a class="post-list-link" href="/hello-world.html">Hello World</a></li></ul>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
    <script>
        $(".post-list").addClass("toc-article");
        $(".post-list-item a").attr("target","_blank");
        $("#post-nav-button > a:nth-child(2)").click(function() {
            $(".fa-bars, .fa-times").toggle();
            $(".post-list").toggle(300);
            if ($(".toc").length > 0) {
                $("#toc, #tocButton").toggle(200, function() {
                    if ($(".switch-area").is(":visible")) {
                        $("#tocButton").attr("value", valueHide);
                        }
                    })
            }
            else {
            }
        })
    </script>



    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2019 MeteoBoy4
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/luuman/hexo-theme-spfk" target="_blank">spfk</a> by luuman
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >水汽辐合量: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本地降水量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>

    </div>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>

    <script>
        $(document).ready(function() {
            var backgroundnum = 17;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>


<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-93016689-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->



	<script>
	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "//hm.baidu.com/hm.js?68c3286313aafcd56004949332118c3d";
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();
	</script>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(

            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


  </div>
</body>
</html>